(()=>{"use strict";const e=e=>{const t=document.getElementById("tbody");t.innerHTML="",e.forEach((e=>{t.insertAdjacentHTML("beforeend",`\n            <tr class="table__row">\n                <td class="table__id table__cell">${e.id}</td>\n                <td class="table-type table__cell">${e.type}</td>\n                <td class="table-name table__cell">${e.name}</td>\n                <td class="table-units table__cell">${e.units}</td>\n                <td class="table-cost table__cell">${e.cost}</td>\n                <td>\n                    <div class="table__actions table__cell">\n                        <button class="button action-change"><span class="svg_ui"><svg class="action-icon_change"><use xlink:href="./img/sprite.svg#change"></use></svg></span><span>Изменить</span>\n                        </button>\n                        <button class="button action-remove"><span class="svg_ui"><svg class="action-icon_remove"><use xlink:href="./img/sprite.svg#remove"></use></svg></span><span>Удалить</span>\n                        </button>\n                    </div>\n                </td>\n            </tr> `)}))};window.itemService=new class{getItems(){return fetch("http://localhost:4545/items").then((e=>e.json()))}addItems(e){return fetch("http://localhost:4545/items",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then((e=>e.json()))}filterItems(e){return fetch(`http://localhost:4545/items/?type=${e}`).then((e=>e.json()))}},itemService.getItems().then((t=>{e(t)})),(()=>{const e=document.getElementById("typeItem");let t,n=[];itemService.getItems().then((s=>{for(let e=0;e<s.length;e++)e>0?s[e].type!==s[e-1].type&&n.push(s[e]):n.push(s[e]);n.forEach(((n,s)=>{t=document.createElement("option"),t.textContent=n.type,e.options[s].after(t)}))}))})(),(()=>{const t=document.getElementById("typeItem");t.addEventListener("change",(()=>{itemService.getItems().then((n=>{t.options[0]&&e(n),n.forEach((n=>{t.options[t.selectedIndex].textContent===n.type&&itemService.filterItems(n.type).then((t=>{e(t)}))}))}))}))})(),(()=>{const t=document.querySelector(".btn-addItem"),n=document.getElementById("modal"),s=document.querySelector("form"),l=s.querySelectorAll(".input"),a=s.querySelector("#type1"),c=s.querySelector("#name"),o=s.querySelector("#units"),i=s.querySelector("#cost"),r=s.querySelector(".errorText");var d,m;t.addEventListener("click",(()=>{n.style.display="flex"})),n.addEventListener("click",(e=>{(e.target.closest(".button__close")||e.target.closest(".cancel-button")||!e.target.closest(".modal"))&&(e.preventDefault(),s.reset(),n.style.display="",r.style.opacity="")})),m=/\D/g,(d=i).addEventListener("input",(()=>{d.value=d.value.replace(m,"")})),s.addEventListener("submit",(t=>{t.preventDefault();let d=!1;if(l.forEach((e=>{if(""===e.value)return r.style.opacity=1,void(d=!0)})),!s.dataset.item&&!0!==d){r.style.opacity="";const t={type:a.value.trim(),name:c.value.trim(),units:o.value.trim(),cost:+i.value};itemService.addItems(t).then((()=>{itemService.getItems().then((t=>{e(t),s.reset(),setTimeout((()=>{n.style.display=""}),700)})).catch((e=>{console.log(e.message)}))}))}}))})()})();